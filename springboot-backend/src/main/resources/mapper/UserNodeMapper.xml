<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.admin.mapper.UserNodeMapper">

    <select id="getUserNodeWithDetails" resultType="com.admin.common.dto.UserNodeWithDetailDto">
        SELECT
            un.id,
            un.user_id as userId,
            un.node_id as nodeId,
            un.access_type as accessType,
            n.name as nodeName,
            n.ip as ip,
            n.server_ip as serverIp,
            n.traffic_ratio as trafficRatio,
            n.owner_id as ownerId
        FROM user_node un
        LEFT JOIN node n ON un.node_id = n.id
        WHERE un.user_id = #{userId}
        ORDER BY un.id
    </select>

</mapper>
